<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>CObject: CClass Struct Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CObject
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="classes.html"><span>Data&#160;Structure&#160;Index</span></a></li>
      <li><a href="inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Data&#160;Fields</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('structCClass.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle">
<div class="title">CClass Struct Reference<div class="ingroups"><a class="el" href="group__Class.html">Class</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>First variables in every object's memory allocation.  
 <a href="structCClass.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="Class_8h_source.html">Class.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a22d5dd694f4ce9212967642c9316c25d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a22d5dd694f4ce9212967642c9316c25d"></a>
void *&#160;</td><td class="memItemRight" valign="bottom"><b>_rt</b></td></tr>
<tr class="separator:a22d5dd694f4ce9212967642c9316c25d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a704cc2137f22dbcf63db9494d1ae2c40"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a704cc2137f22dbcf63db9494d1ae2c40"></a>
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>_vo</b></td></tr>
<tr class="separator:a704cc2137f22dbcf63db9494d1ae2c40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This appears as the first member in all class and interface structures. The <a class="el" href="structCObject.html" title="Base class. ">CObject</a> and <a class="el" href="structCInterface.html" title="Base interface. ">CInterface</a> structure has this as their first member. By including <a class="el" href="structCObject.html" title="Base class. ">CObject</a> or <a class="el" href="structCInterface.html" title="Base interface. ">CInterface</a> as the first member in another structure, this becomes that structures first member. <br />
By doing this, a pointer to any object, which has as it's first member one of struct <a class="el" href="structCObject.html" title="Base class. ">CObject</a> or struct <a class="el" href="structCInterface.html" title="Base interface. ">CInterface</a>, can be safely type cast to a pointer to a struct <a class="el" href="structCClass.html" title="First variables in every object&#39;s memory allocation. ">CClass</a>. <br />
This is used to back track to the base address of an object and the base address of the virtual table. It is very important that this structure is the first member in every class/interface structure. <br />
This works because of the C99 standard in ISO/IEC 9899 6.7.2.1.13, which says in part: <br />
"A pointer to a structure object, suitably converted, points to its initial member (or if that member is a bit-field, then to the unit in which it resides), and vice versa. There may be unnamed padding within a structure object, but not at its beginning." <br />
Consider a class hierchy: </p><pre class="fragment">|-------------------------|       |-------------------------|        |---------|
| ClassB                  | ----&gt; | ClassA                  | -----&gt; | CObject |
|-------------------------|       |-------------------------|   |    |---------|
| int varB                |       | int varA                |   |
|-------------------------|       |-------------------------|   |--&gt; |-----------------------------|
| void methodB( ClassB* ) |       | void methodA( ClassA* ) |   |    | Interface0                  |
|-------------------------|       |-------------------------|   |    |-----------------------------|
                                                                |    | void method0( Interface0* ) |
                                                                |    |-----------------------------|
                                                                |
                                                                |--&gt; |-----------------------------|
                                                                     | Interface1                  |
                                                                     |-----------------------------|
                                                                     | void method1( Interface1* ) |
                                                                     |-----------------------------|
</pre><p> where ClassA inherits from <a class="el" href="structCObject.html" title="Base class. ">CObject</a> and implements Interface0 and Interface1. ClassB inherits from ClassA. If there is a variable of type ClassB: </p><div class="fragment"><div class="line">ClassB* anObject;</div></div><!-- fragment --><p> Then in memory the layout looks like this: </p><pre class="fragment">                      --------------------------------------------
                      |                                    |  |  |
                      |                                    |  |  |
            anObject: ---&gt;  | void* C_ROOT               | -  |  |
                            | size_t C_VTABLE_OFFSET = 0 |    |  |
         -------------------| const void* C_VTABLE       |    |  |                         
         |                  | void (*free)( void* )      |    |  |
         |     Interface0:  | void* C_ROOT               | ---   |
         |                  | size_t C_VTABLE_OFFSET = 2 |       |
         |     Interface1:  | void* C_ROOT               | -------
         |                  | size_t C_VTABLE_OFFSET = 3 |
         |         ClassA:  | int varA                   |
         |         ClassB:  | int varB                   |
         |
         |
         ----&gt; vtable --&gt; | void (*CDestructor)( void* )    |
                          | void (*methodA)( ClassA* )      |
                          | void (*method0)( Interface0* )  |
                          | void (*_method1)( Interface1* ) |
                          | void (*methodB)( ClassB* )      |
</pre><p> Given this mapping of pointers, the virtual table can always be found and the entire objects memory location known regardless of the pointer reference. For example, with a reference to Interface0 (5'th row in layout above), the virtual table is found by using C_ROOT to find the top of the object's memory, then going to the third row to get a pointer to the virtual table. Then, the offset into the virtual table of Interface0's methods is found by using the C_VTABLE_OFFSET from the Interface0 reference. Note, the layout of the virtual table is different when function overriding is used. In this example, ClassA doesn't override any methods from <a class="el" href="structCObject.html" title="Base class. ">CObject</a> and ClassB doesn't override any methods from ClassA and/or <a class="el" href="structCObject.html" title="Base class. ">CObject</a>.</p>
<p>The virtual tables leverage the 6.7.2.1.13 rule as well. Each class' table is declared such that the super class' virtual table is always the first member of the structure. By doing this, a class' virtual table can always be safetly type cast to a table of the super class. The same is not true interfaces, hence, their table offset value is never zero. </p>
</div><hr/>The documentation for this struct was generated from the following file:<ul>
<li>liba/Class/<a class="el" href="Class_8h_source.html">Class.h</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="structCClass.html">CClass</a></li>
    <li class="footer">Generated on Thu Jun 8 2017 21:39:17 for CObject by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
